$(document).ready(function () {
  itemNav = document.querySelectorAll(".item-container .item-nav");
  itemNav.forEach((item) => {
    item.addEventListener("click", () => {
      if (!item.classList.contains("active-nav")) {
        window.scrollTo({
          top: 0,
          behavior: "smooth", // Optional: smooth scrolling animation
        });
        document.querySelector(".active-nav").classList.remove("active-nav");
        item.classList.add("active-nav");
        //
        document.querySelector(".active-page").classList.remove("active-page");

        if (item.getAttribute("value") == "home") {
          document.querySelector(".voucher").classList.add("active-page");
          console.log("real home");
        } else {
          document.querySelector(".home").classList.add("active-page");
        }
        setTimeout(() => {
          swiper1.update();
        }, 200);

        resetAos = () => {
          console.log("reset AOS");
          elementHasRefrestAos = document.querySelectorAll(".aos-animate");
          elementHasRefrestAos.forEach((aos) => {
            aos.classList.remove("aos-animate");
          });

          setTimeout(() => {
            AOS.init();
            AOS.refreshHard();
          }, 300);
        };

        resetAos();
      }
    });
  });

  //Active btn

  // Main container

  isFirst = true;

  var swiper1 = new Swiper(".swiper-1", {
    slidesPerView: 3,
    spaceBetween: 0,
    loop: true,
    navigation: {
      nextEl: ".main-slide .swiper-button-next",
      prevEl: ".main-slide .swiper-button-prev",
    },
    centeredSlides: true,
    autoplay: {
      delay: 5000, // Thời gian trễ giữa các slide (milisecond)
      disableOnInteraction: true, // Tắt autoplay khi người dùng thao tác với swiper (true: tắt, false: không tắt)
    },
    on: {
      slideChange: function () {
        if (!isFirst) {
          var currentIndex = this.realIndex; // Chỉ mục của slide hiện tại
          console.log(currentIndex);
          // if (currentIndex < 5) {
          //   currentIndex++;
          // } else {
          //   currentIndex = 0;
          // }
          document.querySelector(".main-slide-active-nav-item").classList.remove("main-slide-active-nav-item");
          navMainItems = document.querySelectorAll(".main-slide .nav-slide-item");
          navMainItems[currentIndex].classList.add("main-slide-active-nav-item");
        } else {
          isFirst = false;
        }
      },
    },
  });

  var swiper2 = new Swiper(".swiper-2", {
    slidesPerView: 1,
    spaceBetween: 0,
    loop: true,
    speed: 1000,
    effect: "fade",
    navigation: {
      nextEl: ".swiper-button-next.modal-next",
      prevEl: ".swiper-button-prev.modal-prev",
    },
    pagination: {
      el: ".modal-body .swiper-pagination",
      clickable: true,
    },
  });

  setTimeout(() => {
    navMainItems = document.querySelectorAll(".main-slide .nav-slide-item");
    navMainItems.forEach((element) => {
      element.addEventListener("click", () => {
        document.querySelector(".main-slide-active-nav-item").classList.remove("main-slide-active-nav-item");
        element.classList.add("main-slide-active-nav-item");
        // alert("123");
        // value = parseInt(element.getAttribute("value"));
        value = parseInt(element.getAttribute("value"));
        var targetIndex = value;
        swiper1.autoplay.stop();
        switch (targetIndex) {
          case 0: {
            targetIndex = 3;
            break;
          }
          case 1: {
            targetIndex = 4;
            break;
          }
          case 2: {
            targetIndex = 5;
            break;
          }
          case 3: {
            targetIndex = 6;
            break;
          }
          case 4: {
            targetIndex = 7;
            break;
          }
          case 5: {
            targetIndex = 8;
            break;
          }
        }
        console.log(value);
        setTimeout(() => {
          swiper1.slideTo(targetIndex, 500);
        }, 300);
        showPopup(value + 1);
      });
    });
  }, 1000);

  showPopup = (index) => {
    var myModal = new bootstrap.Modal(document.getElementById("exampleModalLong"));
    myModal.show();
    setTimeout(() => {
      swiper2.update();
      swiper2.slideTo(index, 0, false);
    }, 400);
  };

  //Change title nav

  navTitles = document.querySelectorAll(".title-nav");
  navTitles.forEach((titleNav) => {
    titleNav.addEventListener("click", () => {
      titleContainer = titleNav.closest(".title-car-container");
      swiperSlide = titleNav.closest(".swiper-slide");
      console.log(titleContainer);
      navInContainer = titleContainer.querySelectorAll(".title-nav");
      if (navInContainer.length > 1) {
        //change title butoon
        titleContainer.querySelector(".active-title-nav").classList.remove("active-title-nav");
        titleNav.classList.add("active-title-nav");
        // change content
        pageTarget = swiperSlide.querySelector(`.page-${titleNav.getAttribute("value")}`);
        currentPage = swiperSlide.querySelector(".page-modal-active");
        currentPage.classList.remove("page-modal-active");
        pageTarget.classList.add("page-modal-active");
        console.log(pageTarget);
      }
    });
  });
});

// write function convert string to number

// write function change background when click on button has id = "haha"
